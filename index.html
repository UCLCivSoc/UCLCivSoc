<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UCL CivSoc | Civil Engineering Society</title>

    <link rel="icon" type="image/png" href="images/website/civsoclogo.png">
<link rel="apple-touch-icon" href="images/website/civsoclogo.png">
    
    <meta name="description" content="Official website of the UCL Civil Engineering Society (CivSoc). News, events, committee contacts, and transparency reports.">
    <meta name="keywords" content="UCL, CivSoc, Civil Engineering, Society, Students Union, London, Engineering">
    <meta name="author" content="UCL CivSoc Committee">
    
    <meta property="og:title" content="UCL CivSoc | News & Reports">
    <meta property="og:description" content="Stay updated with the latest socials, career events, and committee transparency reports.">
    <meta property="og:image" content="images/website/civsoclogo.png"> 
    <meta property="og:url" content="https://ucl-civsoc.github.io/"> 
    <meta property="og:type" content="website">

    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="toast-container"></div>
    <button id="repair-btn" onclick="location.reload()">
        ğŸš§ SITE FAILURE DETECTED <br> CLICK TO REPAIR
    </button>

    <div id="loader-overlay">
        <div class="loader-lines">
            <div class="line"></div>
            <div class="line"></div>
            <div class="line"></div>
            <div class="line"></div>
            <div class="line"></div>
        </div>
        <div class="loader-logo-box">
            <img src="images/website/civsoclogo.png" class="loader-logo-img" alt="Loading...">
        </div>
    </div>

    <nav>
        <div class="logo" onclick="switchView('news')"> 
            <div class="logo-container">
                <img src="images/website/civsoclogo.png" class="nav-logo-img" alt="UCL CivSoc"> 
            </div>
            Est. 2016
        </div>
        
        <div id="nav-main-menu" class="nav-group">
            <button id="main-comp-btn" class="nav-btn" onclick="window.location.href='competition/index.html'" style="border-color: var(--su-yellow); color: var(--su-yellow);">
                <span>ğŸ† Term Contest</span> 
            </button>
            <button class="nav-btn" onclick="switchView('committee')">
                <span>ğŸ‘¥ Meet the Committee</span>
            </button>
            <button class="nav-btn" onclick="switchView('report')">
                <span>ğŸ“Š Glass Reportsâ„¢</span> 
            </button>
        </div>

        <div id="nav-back-menu" class="nav-group" style="display: none;">
            <button class="nav-btn back-mode" onclick="switchView('news')">
                <span>â† Back to News</span>
            </button>
        </div>
    </nav>

    <div id="news-view">
        <div class="ticket-section" id="ticket-section">
            <div class="ticket-header">
                <span style="border-bottom: 2px solid #81d4fa; padding-bottom:3px;">ğŸŸï¸ Ticketed Events</span>
            </div>
            <div class="ticker-wrapper"><div class="ticker-track" id="ticker-track"></div></div>
        </div>

        <div class="next-event-container" id="next-event-container">
            <div class="next-event-hero" id="next-event-hero"></div>
            <div class="next-event-list" id="next-event-list"></div>
        </div>

        <div class="filter-nav">
            <div class="filter-title">News Categories</div>
            <div class="filter-buttons">
                <button class="filter-btn active" onclick="filterGrid('all', this)">All</button>
                <button class="filter-btn" onclick="filterGrid('social', this)">Social</button>
                <button class="filter-btn" onclick="filterGrid('career', this)">Career</button>
                <button class="filter-btn" onclick="filterGrid('academic', this)">Academic</button>
                <button class="filter-btn" onclick="filterGrid('admin', this)">Admin</button>
            </div>
        </div>

        <header>
            <h1>Society News</h1>
            <p class="subtitle">Latest updates, events, and announcements.</p>
        </header>

        <div class="grid-container" id="grid-container">
            <div class="no-results" id="no-results">No updates found in this category.</div>
        </div>
    </div>

    <div id="report-view" style="display:none;">
        <div class="report-layout">
            <div class="report-sidebar" id="report-sidebar"></div>
            <div class="report-content" id="report-content"></div>
        </div>
    </div>

  <div id="committee-view" style="display:none;">
        <header>
            <h1>Meet the Committee</h1>
            <p class="subtitle">The 2025/26 Committee working behind the scenes.</p>
            
            <a href="docs/constitution.pdf" target="_blank" class="constitution-link">
                ğŸ“œ View Society Constitution (PDF)
            </a>
        </header>
        <div class="committee-grid" id="committee-grid"></div>
    </div>

    <div class="modal-overlay" id="article-modal"></div>
    <button id="back-to-top-btn" onclick="scrollToTop()">â†‘</button>
    
    <div id="footer-placeholder"></div>
    <!-- Firebase SDK (Must be before script.js) -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js"></script>

    <script src="layout.js"></script>
    <script>
        renderFooter('footer-placeholder', { withPillars: true });
    </script>

    <script src="data.js"></script>
    <script src="script.js"></script>
    <script src="eggs.js"></script>
    
<script src="competition/config.js"></script>
    <script>
        window.addEventListener('load', () => {
            // Check if config exists
            if (typeof CONFIG === 'undefined' || !CONFIG.end_date) return;

            const btn = document.getElementById('main-comp-btn');
            if (!btn) return;

            // Calculate Dates
            const votingDeadline = new Date(CONFIG.end_date);
            const resultsDeadline = new Date(votingDeadline.getTime() + (CONFIG.results_duration_days * 24 * 60 * 60 * 1000));
            const now = new Date();
            
            // 3 Months in Milliseconds (approx 90 days)
            const threeMonths = 90 * 24 * 60 * 60 * 1000;

            // LOGIC TREE:
            
            // 1. TOO EARLY? (More than 3 months away) -> Hide Button
            if ((votingDeadline - now) > threeMonths) {
                btn.style.display = "none";
            }
            // 2. RESULTS MODE? (Deadline Passed but before Archive) -> Show Gold
            else if (now > votingDeadline && now < resultsDeadline) {
                btn.innerHTML = "<span>ğŸ† RESULTS OUT !</span>";
                btn.style.backgroundColor = "var(--su-yellow)";
                btn.style.color = "black";
                btn.style.borderColor = "var(--su-yellow)";
                btn.style.boxShadow = "0 0 15px rgba(246, 190, 0, 0.6)"; 
                btn.style.animation = "pulse 2s infinite";
            } 
            // 3. ARCHIVED? (Results period over) -> Hide Button
            else if (now > resultsDeadline) {
                btn.style.display = "none";
            }
            // 4. ELSE: Default "Term Contest" (Standard visibility)
        });
    </script>
</body>
</html>